clc, clearvars
%10000 trajectories. histogram to see see distribution of lengths. look at
%speed. accuracy of wire in field. make
%sure inside points are different in the eField for the modified and
%unmodified points. (in a different figure). write a report and share it
%online. graphical interface to select points. ranges = user defined percentages.  

% Select fixed points to define wire trajectory
% define these points to correspond within the simulated electric field.


points = [-0.0217 -0.0667 -0.0942;...
    0.0233 -0.0017 0.0758;... 
    0.0233 -0.0417 0.3358;...
   -0.2467 -0.2367 1.1658];

% Set random range in each direction
x_ranges = [-0.0717 0.0483;...
   -0.0217 0.0633;...
   -0.0317 0.0733;...
   -0.2817 -0.2067];
 
y_ranges = [-0.1167 -0.0117;...
   -0.0517 0.0483;...
   -0.1117 -0.0117;...
   -0.2917 -0.1867];

z_ranges = [-0.1592 -0.0742;...
    0.0008 0.1108;...
    0.2808 0.4208;...
    1.1208 1.2208];


ranges = [x_ranges y_ranges z_ranges];

% Select wire points to randomly move
changing = [1 2];

%importfile('Duke 1p5T B1 02Nov21.mat')
s1 = load('simulatedBodyCoilEfield (1).mat');

% [Efield,Axis0,Axis1,Axis2] = interpfield(s1); 


%rename sar_short
tic
[output, wire_lengths, output3] = graph_creation2(...
    points',...
    ranges,...
    changing,...
    s1,...
    'nom_length', 1.2,...
    'show_plot', true,...
    'show_graph', true,...
    'intersecting_index', 3,...
    'num_steps', 10,...
    'give_warnings', false, ...
    'direction', "Right", ...
    'show_electric', true);
toc


%Elapsed times:
% 125 trajectories: ~153 seconds
% 1000 trajectories: 924.4 seconds
% 1000000 trajectories: way too long